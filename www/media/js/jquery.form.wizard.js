/**
 * @license jQuery wizard plug-in 3.0.7 (18-SEPT-2012)
 *
 *
 * Copyright (c) 2012 Jan Sundman (jan.sundman[at]aland.net)
 *
 * http://www.thecodemine.org
 *
 * Licensed under the MIT licens:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 */
!function(a){a.widget("ui.formwizard",{_init:function(){var b=this,c=this.options.formOptions.success,d=this.options.formOptions.complete,e=this.options.formOptions.beforeSend,f=this.options.formOptions.beforeSubmit,g=this.options.formOptions.beforeSerialize;return this.options.formOptions=a.extend(this.options.formOptions,{success:function(a,d,e){c&&c(a,d,e),(b.options.formOptions&&b.options.formOptions.resetForm||!b.options.formOptions)&&b._reset()},complete:function(a,c){d&&d(a,c),b._enableNavigation()},beforeSubmit:function(a,c,d){if(f){var e=f(a,c,d);return e||b._enableNavigation(),e}},beforeSend:function(a){if(e){var c=e(a);return c||b._enableNavigation(),c}},beforeSerialize:function(a,c){if(g){var d=g(a,c);return d||b._enableNavigation(),d}}}),this.options.historyEnabled&&a.bbq.removeState("_"+a(this.element).attr("id")),this.steps=this.element.find(".step").hide(),this.firstStep=this.steps.eq(0).attr("id"),this.activatedSteps=new Array,this.isLastStep=!1,this.previousStep=void 0,this.currentStep=this.steps.eq(0).attr("id"),this.nextButton=this.element.find(this.options.next).click(function(){return b._next()}),this.nextButtonInitinalValue=this.nextButton.val(),this.nextButton.val(this.options.textNext),this.backButton=this.element.find(this.options.back).click(function(){return b._back(),!1}),this.backButtonInitinalValue=this.backButton.val(),this.backButton.val(this.options.textBack),this.options.validationEnabled&&void 0==jQuery().validate?(this.options.validationEnabled=!1,void 0!==window.console&&console.log("%s","validationEnabled option set, but the validation plugin is not included")):this.options.validationEnabled&&this.element.validate(this.options.validationOptions),this.options.formPluginEnabled&&void 0==jQuery().ajaxSubmit&&(this.options.formPluginEnabled=!1,void 0!==window.console&&console.log("%s","formPluginEnabled option set but the form plugin is not included")),1==this.options.disableInputFields&&a(this.steps).find(":input:not('.wizard-ignore')").attr("disabled","disabled"),this.options.historyEnabled&&a(window).bind("hashchange",void 0,function(c){var d=c.getState("_"+a(b.element).attr("id"))||b.firstStep;if(d!==b.currentStep){if(b.options.validationEnabled&&d===b._navigate(b.currentStep)&&!b.element.valid())return b._updateHistory(b.currentStep),b.element.validate().focusInvalid(),!1;d!==b.currentStep&&b._show(d)}}),this.element.addClass("ui-formwizard"),this.element.find(":input").addClass("ui-wizard-content"),this.steps.addClass("ui-formwizard-content"),this.backButton.addClass("ui-formwizard-button ui-wizard-content"),this.nextButton.addClass("ui-formwizard-button ui-wizard-content"),this.options.disableUIStyles||(this.element.addClass("ui-helper-reset ui-widget ui-widget-content ui-helper-reset ui-corner-all"),this.element.find(":input").addClass("ui-helper-reset ui-state-default"),this.steps.addClass("ui-helper-reset ui-corner-all"),this.backButton.addClass("ui-helper-reset ui-state-default"),this.nextButton.addClass("ui-helper-reset ui-state-default")),this._show(void 0),a(this)},_next:function(){if(this.options.validationEnabled&&!this.element.valid())return this.element.validate().focusInvalid(),!1;if(void 0!=this.options.remoteAjax){var b=this.options.remoteAjax[this.currentStep],c=this;if(void 0!==b){var d=b.success,e=b.beforeSend,f=b.complete;return b=a.extend({},b,{success:function(a,b){(void 0!==d&&d(a,b)||void 0==d)&&c._continueToNextStep()},beforeSend:function(b){c._disableNavigation(),void 0!==e&&e(b),a(c.element).trigger("before_remote_ajax",{currentStep:c.currentStep})},complete:function(b,d){void 0!==f&&f(b,d),a(c.element).trigger("after_remote_ajax",{currentStep:c.currentStep}),c._enableNavigation()}}),this.element.ajaxSubmit(b),!1}}return this._continueToNextStep()},_back:function(){return this.activatedSteps.length>0&&(this.options.historyEnabled?this._updateHistory(this.activatedSteps[this.activatedSteps.length-2]):this._show(this.activatedSteps[this.activatedSteps.length-2],!0)),!1},_continueToNextStep:function(){if(this.isLastStep){for(var a=0;a<this.activatedSteps.length;a++)this.steps.filter("#"+this.activatedSteps[a]).find(":input").not(".wizard-ignore").removeAttr("disabled");return this.options.formPluginEnabled?(this._disableNavigation(),this.element.ajaxSubmit(this.options.formOptions),!1):!0}var b=this._navigate(this.currentStep);return b==this.currentStep?!1:(this.options.historyEnabled?this._updateHistory(b):this._show(b,!0),!1)},_updateHistory:function(b){var c={};c["_"+a(this.element).attr("id")]=b,a.bbq.pushState(c)},_disableNavigation:function(){this.nextButton.attr("disabled","disabled"),this.backButton.attr("disabled","disabled"),this.options.disableUIStyles||(this.nextButton.removeClass("ui-state-active").addClass("ui-state-disabled"),this.backButton.removeClass("ui-state-active").addClass("ui-state-disabled"))},_enableNavigation:function(){this.isLastStep?this.nextButton.val(this.options.textSubmit):this.nextButton.val(this.options.textNext),a.trim(this.currentStep)!==this.steps.eq(0).attr("id")&&(this.backButton.removeAttr("disabled"),this.options.disableUIStyles||this.backButton.removeClass("ui-state-disabled").addClass("ui-state-active")),this.nextButton.removeAttr("disabled"),this.options.disableUIStyles||this.nextButton.removeClass("ui-state-disabled").addClass("ui-state-active")},_animate:function(a,b,c){this._disableNavigation();var d=this.steps.filter("#"+a),e=this.steps.filter("#"+b);d.find(":input").not(".wizard-ignore").attr("disabled","disabled"),e.find(":input").not(".wizard-ignore").removeAttr("disabled");var f=this;d.animate(f.options.outAnimation,f.options.outDuration,f.options.easing,function(){e.animate(f.options.inAnimation,f.options.inDuration,f.options.easing,function(){f.options.focusFirstInput&&e.find(":input:first").focus(),f._enableNavigation(),c.apply(f)})})},_checkIflastStep:function(b){this.isLastStep=!1,(a("#"+b).hasClass(this.options.submitStepClass)||this.steps.filter(":last").attr("id")==b)&&(this.isLastStep=!0)},_getLink:function(b){var c=void 0,d=this.steps.filter("#"+b).find(this.options.linkClass);return void 0!=d&&(c=d.filter(":radio,:checkbox").size()>0?d.filter(this.options.linkClass+":checked").val():a(d).val()),c},_navigate:function(a){var b=this._getLink(a);if(void 0!=b)return""!=b&&null!=b&&void 0!=b&&void 0!=this.steps.filter("#"+b).attr("id")?b:this.currentStep;if(void 0==b&&!this.isLastStep){var c=this.steps.filter("#"+a).next().attr("id");return c}},_show:function(b){var c=!1,d=void 0!==b;if(void 0==b||""==b?(this.activatedSteps.pop(),b=this.firstStep,this.activatedSteps.push(b)):a.inArray(b,this.activatedSteps)>-1?(c=!0,this.activatedSteps.pop()):this.activatedSteps.push(b),this.currentStep!==b||b===this.firstStep){this.previousStep=this.currentStep,this._checkIflastStep(b),this.currentStep=b;var e=function(){d&&a(this.element).trigger("step_shown",a.extend({isBackNavigation:c},this._state()))};d&&a(this.element).trigger("before_step_shown",a.extend({isBackNavigation:c},this._state())),this._animate(this.previousStep,b,e)}},_reset:function(){this.element.resetForm(),a("label,:input,textarea",this).removeClass("error");for(var b=0;b<this.activatedSteps.length;b++)this.steps.filter("#"+this.activatedSteps[b]).hide().find(":input").attr("disabled","disabled");this.activatedSteps=new Array,this.previousStep=void 0,this.isLastStep=!1,this.options.historyEnabled?this._updateHistory(this.firstStep):this._show(this.firstStep)},_state:function(a){var b={settings:this.options,activatedSteps:this.activatedSteps,isLastStep:this.isLastStep,isFirstStep:this.currentStep===this.firstStep,previousStep:this.previousStep,currentStep:this.currentStep,backButton:this.backButton,nextButton:this.nextButton,steps:this.steps,firstStep:this.firstStep};return void 0!==a?b[a]:b},show:function(a){this.options.historyEnabled?this._updateHistory(a):this._show(a)},state:function(a){return this._state(a)},reset:function(){this._reset()},next:function(){this._next()},back:function(){this._back()},destroy:function(){this.element.find("*").removeAttr("disabled").show(),this.nextButton.unbind("click").val(this.nextButtonInitinalValue).removeClass("ui-state-disabled").addClass("ui-state-active"),this.backButton.unbind("click").val(this.backButtonInitinalValue).removeClass("ui-state-disabled").addClass("ui-state-active"),this.backButtonInitinalValue=void 0,this.nextButtonInitinalValue=void 0,this.activatedSteps=void 0,this.previousStep=void 0,this.currentStep=void 0,this.isLastStep=void 0,this.options=void 0,this.nextButton=void 0,this.backButton=void 0,this.formwizard=void 0,this.element=void 0,this.steps=void 0,this.firstStep=void 0},update_steps:function(){this.steps=this.element.find(".step").addClass("ui-formwizard-content"),this.firstStep=this.steps.eq(0).attr("id"),this.steps.not("#"+this.currentStep).hide().find(":input").addClass("ui-wizard-content").attr("disabled","disabled"),this._checkIflastStep(this.currentStep),this._enableNavigation(),this.options.disableUIStyles||(this.steps.addClass("ui-helper-reset ui-corner-all"),this.steps.find(":input").addClass("ui-helper-reset ui-state-default"))},options:{historyEnabled:!1,validationEnabled:!1,validationOptions:void 0,formPluginEnabled:!1,linkClass:".link",submitStepClass:"submit_step",back:":reset",next:":submit",textSubmit:"Submit",textNext:"Next",textBack:"Back",remoteAjax:void 0,inAnimation:{opacity:"show"},outAnimation:{opacity:"hide"},inDuration:400,outDuration:400,easing:"swing",focusFirstInput:!1,disableInputFields:!0,formOptions:{reset:!0,success:function(){void 0!==window.console&&console.log("%s","form submit successful")},disableUIStyles:!1}}})}(jQuery);